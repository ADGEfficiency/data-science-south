<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      /* Prevent flash of white background while CSS loads */
      html.dark { background-color: #111827; color: #ffffff; }
      html.dark body { background-color: #111827; }
      html.dark header { background-color: #111827; }
    </style>
    <script>
      // Prevent flash of white by checking theme immediately
      ;(function () {
        const theme = localStorage.getItem('theme')
        if (theme === 'dark') {
          document.documentElement.classList.add('dark')
        }
      })()
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            typography: {
              DEFAULT: {
                css: {
                  maxWidth: 'none',
                  h1: {
                    marginTop: '1rem',
                    marginBottom: '1rem',
                  },
                  h2: {
                    marginTop: '1em',
                    marginBottom: '0.5rem',
                  },
                  h3: {
                    marginTop: '1rem',
                    marginBottom: '0.75rem',
                  },
                  h4: {
                    marginTop: '0.875rem',
                    marginBottom: '0.5rem',
                  },
                  'code::before': {
                    content: '""', // Removes the backtick
                  },
                  'code::after': {
                    content: '""', // Removes the backtick
                  },
                },
              },
            },
          },
        },
      }
    </script>
    {{ if true }} {{ $style := resources.Get "css/syntax.css" | resources.Minify
    }}
    <link rel="stylesheet" href="{{ $style.RelPermalink }}" />
    {{ end }}
    {{ $mainStyle := resources.Get "css/main.css" | resources.Minify }}
    <link rel="stylesheet" href="{{ $mainStyle.RelPermalink }}" />
    {{ if .Param "math" }} {{ partialCached "math.html" . }} {{ end }}
    <title data-pagefind-meta="title">{{.Title}}</title>
    <script
      defer
      data-domain="datasciencesouth.com"
      src="https://plausible.io/js/script.js"
    ></script>
    <script>
      window.plausible =
        window.plausible ||
        function () {
          ;(window.plausible.q = window.plausible.q || []).push(arguments)
        }
    </script>
    <script>
      // Dark mode toggle functionality
      const themeToggle = document.addEventListener(
        'DOMContentLoaded',
        function () {
          const themeToggle = document.getElementById('theme-toggle')
          const sunIcon = document.getElementById('sun-icon')
          const moonIcon = document.getElementById('moon-icon')
          const html = document.documentElement

          // Check for saved theme preference or default to light mode
          const currentTheme = localStorage.getItem('theme') || 'light'

          if (currentTheme === 'dark') {
            html.classList.add('dark')
            sunIcon.classList.remove('hidden')
            moonIcon.classList.add('hidden')
          } else {
            html.classList.remove('dark')
            sunIcon.classList.add('hidden')
            moonIcon.classList.remove('hidden')
          }

          // Toggle theme on button click
          themeToggle.addEventListener('click', function () {
            if (html.classList.contains('dark')) {
              // Switch to light mode
              html.classList.remove('dark')
              sunIcon.classList.add('hidden')
              moonIcon.classList.remove('hidden')
              localStorage.setItem('theme', 'light')
            } else {
              // Switch to dark mode
              html.classList.add('dark')
              sunIcon.classList.remove('hidden')
              moonIcon.classList.add('hidden')
              localStorage.setItem('theme', 'dark')
            }
          })
        }
      )
    </script>
    <link href="/pagefind/pagefind-ui.css" rel="stylesheet">
    <script src="/pagefind/pagefind-ui.js"></script>
    <style>
      .pagefind-ui__drawer {
        background-color: transparent !important;
        border: none !important;
        border-radius: 0 !important;
        margin-top: 0 !important;
        box-shadow: none !important;
        max-height: none !important;
      }
      
      .pagefind-ui__result {
        background-color: rgba(255, 255, 255, 0.8) !important;
        backdrop-filter: blur(8px) !important;
        border-bottom: 1px solid rgba(229, 231, 235, 0.5) !important;
        padding: 1rem !important;
        margin: 0.25rem !important;
        border-radius: 0.5rem !important;
        border: 1px solid rgba(255, 255, 255, 0.2) !important;
        transition: all 0.2s ease !important;
        transform: translateY(0) !important;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1) !important;
      }
      
      .pagefind-ui__result:hover {
        background-color: rgb(16 185 129) !important;
        transform: translateY(-2px) !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
        border-color: rgb(16 185 129) !important;
      }
      
      .pagefind-ui__result-title {
        color: rgb(17 24 39) !important;
        font-weight: 600 !important;
        margin-bottom: 0.5rem !important;
        font-size: 1rem !important;
        transition: color 0.2s ease !important;
      }
      
      .pagefind-ui__result:hover .pagefind-ui__result-title {
        color: rgb(236 253 245) !important;
      }
      
      .pagefind-ui__result-excerpt,
      .pagefind-ui__result-nested {
        display: none !important;
      }
      
      .pagefind-ui__result-link {
        color: inherit !important;
        text-decoration: none !important;
      }
      
      .pagefind-ui__result-title a {
        color: rgb(17 24 39) !important;
        text-decoration: none !important;
        transition: color 0.2s ease !important;
      }
      
      .pagefind-ui__result:hover .pagefind-ui__result-title a {
        color: rgb(236 253 245) !important;
      }
      
      .pagefind-ui__search-clear,
      .pagefind-ui__search-input {
        display: none !important;
      }
      
      .pagefind-ui__form::before,
      .pagefind-ui__search-icon,
      .pagefind-ui__form svg,
      .pagefind-ui svg {
        display: none !important;
      }
      
      .pagefind-ui__message {
        display: none !important;
      }
      
      .pagefind-ui__stats {
        display: none !important;
      }
      
      .pagefind-ui__results-area > p {
        display: none !important;
      }
      
      .pagefind-ui__button {
        background-color: rgb(16 185 129) !important;
        color: white !important;
        border: none !important;
        padding: 0.75rem 1.5rem !important;
        border-radius: 0.5rem !important;
        font-weight: 600 !important;
        cursor: pointer !important;
        transition: all 0.2s ease !important;
        margin: 1rem auto !important;
        display: block !important;
        width: fit-content !important;
      }
      
      .pagefind-ui__button:hover {
        background-color: rgb(5 150 105) !important;
        transform: translateY(-1px) !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
      }
      
      /* Dark mode styles */
      .dark .pagefind-ui__result {
        background-color: rgba(31, 41, 55, 0.8) !important;
        backdrop-filter: blur(8px) !important;
        border-bottom-color: rgba(75, 85, 99, 0.5) !important;
        border-color: rgba(75, 85, 99, 0.2) !important;
      }
      
      .dark .pagefind-ui__result:hover {
        background-color: rgb(16 185 129) !important;
        border-color: rgb(16 185 129) !important;
      }
      
      .dark .pagefind-ui__result-title {
        color: white !important;
      }
      
      .dark .pagefind-ui__result:hover .pagefind-ui__result-title {
        color: rgb(236 253 245) !important;
      }
      
      .dark .pagefind-ui__result-title a {
        color: white !important;
      }
      
      .dark .pagefind-ui__result:hover .pagefind-ui__result-title a {
        color: rgb(236 253 245) !important;
      }
      
      .dark .pagefind-ui__message {
        display: none !important;
      }
      
      .dark .pagefind-ui__button {
        background-color: rgb(16 185 129) !important;
        color: white !important;
      }
      
      .dark .pagefind-ui__button:hover {
        background-color: rgb(5 150 105) !important;
      }
    </style>
  </head>
  <body
    class="font-sans leading-normal bg-white dark:bg-gray-900 text-gray-900 dark:text-white transition-colors duration-200"
  >
    <header class="bg-gray-800 dark:bg-gray-900 sticky top-0 z-50 p-1 pt-2">
      <div class="container mx-auto flex justify-between items-center">
        <a
          href="/"
          class="group inline-flex items-center pl-0 pr-3 py-0 rounded-lg hover:bg-emerald-500 hover:text-emerald-50 hover:-translate-y-1 hover:shadow-lg transition-all duration-200"
        >
          <img src="/logos/light.svg" alt="Site Logo" width="50" height="50" />
          <h1
            class="text-xl font-bold text-white ml-2 group-hover:text-emerald-50"
          >
            {{ .Site.Title }}
          </h1>
        </a>
        <div class="flex items-center space-x-4">
          <button
            id="search-toggle"
            class="text-white p-2 rounded-lg hover:bg-emerald-500 hover:text-emerald-50 hover:-translate-y-1 hover:shadow-lg transition-all duration-200"
            aria-label="Search"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="11" cy="11" r="8"/>
              <path d="M21 21l-4.35-4.35"/>
            </svg>
          </button>
          {{ partial "dark-mode-toggle.html" . }}
          <a
            href="https://github.com/ADGEfficiency/data-science-south"
            target="_blank"
            rel="noopener noreferrer"
            class="hidden sm:block text-white p-2 rounded-lg hover:bg-emerald-500 hover:text-emerald-50 hover:-translate-y-1 hover:shadow-lg transition-all duration-200"
            aria-label="GitHub Repository"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path
                d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"
              ></path>
            </svg>
          </a>
        </div>
      </div>
    </header>
    
    <!-- Search Overlay -->
    <div id="search-overlay" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm z-50 hidden">
      <div class="min-h-screen px-4 py-8 flex flex-col">
        <div class="max-w-4xl mx-auto w-full">
          <div class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-md rounded-lg shadow-2xl border border-gray-200/50 dark:border-gray-700/50">
            <div class="flex items-center p-4 border-b border-gray-200 dark:border-gray-700">
              <input
                id="search-input"
                type="text"
                placeholder="Search lessons & blogs..."
                class="flex-1 bg-transparent text-gray-900 dark:text-white text-lg placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none"
              >
              <button id="search-close" class="text-gray-400 hover:text-gray-600 dark:hover:text-white ml-4">
                <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="18" y1="6" x2="6" y2="18"></line>
                  <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
              </button>
            </div>
            <div id="search-results" class="min-h-[400px] max-h-[400px] overflow-y-auto"></div>
          </div>
        </div>
      </div>
    </div>
    
    {{ block "main" . }}{{ end }}
    <script src="/js/copyCode.js"></script>
    <script>
      let pagefindInstance = null;
      
      function initializeSearch() {
        if (typeof PagefindUI !== 'undefined' && !pagefindInstance) {
          pagefindInstance = new PagefindUI({ 
            element: "#search-results",
            showImages: false,
            showSubResults: false,
            excerptLength: 0,
            placeholder: "Search lessons & blogs...",
            showEmptyFilters: false,
            resetStyles: false
          });
        } else if (!pagefindInstance) {
          setTimeout(initializeSearch, 100);
        }
      }
      
      function showSearchOverlay() {
        const overlay = document.getElementById('search-overlay');
        const searchInput = document.getElementById('search-input');
        overlay.classList.remove('hidden');
        searchInput.focus();
      }
      
      function hideSearchOverlay() {
        const overlay = document.getElementById('search-overlay');
        const searchInput = document.getElementById('search-input');
        overlay.classList.add('hidden');
        searchInput.value = '';
        // Clear search results
        const resultsContainer = document.getElementById('search-results');
        resultsContainer.innerHTML = '';
      }
      
      function performSearch(query) {
        if (pagefindInstance && query.trim()) {
          // Trigger search by dispatching input event to PagefindUI's internal input
          const pagefindInput = document.querySelector('#search-results input[type="text"]');
          if (pagefindInput) {
            pagefindInput.value = query;
            pagefindInput.dispatchEvent(new Event('input', { bubbles: true }));
          }
        }
      }
      
      window.addEventListener('DOMContentLoaded', (event) => {
        initializeSearch();
        
        // Search toggle functionality
        const searchToggle = document.getElementById('search-toggle');
        const searchClose = document.getElementById('search-close');
        const searchOverlay = document.getElementById('search-overlay');
        const searchInput = document.getElementById('search-input');
        
        searchToggle.addEventListener('click', showSearchOverlay);
        searchClose.addEventListener('click', hideSearchOverlay);
        
        // Close overlay when clicking outside the search box
        searchOverlay.addEventListener('click', (e) => {
          if (e.target === searchOverlay) {
            hideSearchOverlay();
          }
        });
        
        // Handle escape key
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') {
            hideSearchOverlay();
          }
        });
        
        // Handle search input
        searchInput.addEventListener('input', (e) => {
          performSearch(e.target.value);
        });
        
        // Handle enter key in search input
        searchInput.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            e.preventDefault();
            performSearch(e.target.value);
          }
        });
      });
    </script>
  </body>
</html>
